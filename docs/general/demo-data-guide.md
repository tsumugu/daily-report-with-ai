# デモデータ作成ガイド

**作成日**: 2025-12-18  
**作成者**: Eng  
**目的**: 機能をデモするためのサンプルデータを作成する手順

---

## 📋 概要

デモデータ作成スクリプトを使用して、機能をデモするためのサンプルデータを作成できます。

作成されるデータ:

- **ユーザー**: 1名（demo@example.com / password123）
- **目標**: 5個（長期1、中期2、短期2の階層構造）
- **日報**: 約20件（過去4週間分、週5日勤務を想定）
- **よかったこと**: 約40-60件（各日報に2-3個）
- **改善点**: 約20-40件（各日報に1-2個）
- **フォローアップ**: 約18件（よかったこと・改善点に紐付け）
- **週次フォーカス**: 約8-12件（過去4週間分）
- **日報-目標紐付け**: 約10-15件

---

## 🚀 使用方法

### 1. 開発環境で実行

```bash
cd apps/api
npm run seed:demo
```

### 2. 直接実行

```bash
cd apps/api
tsx scripts/seed-demo-data.ts
```

---

## 📝 作成されるデータの詳細

### ユーザー

- **メールアドレス**: `demo@example.com`
- **パスワード**: `password123`
- **作成日**: 30日前

### 目標（階層構造）

#### 長期目標（半期）

- **名前**: エンジニアとしての基礎力を身につける
- **期間**: 90日前〜今日
- **タイプ**: skill

#### 中期目標1（1ヶ月）

- **名前**: テスト駆動開発を実践する
- **期間**: 30日前〜今日
- **親目標**: 長期目標
- **タイプ**: habit

#### 中期目標2（1ヶ月）

- **名前**: コードレビューで建設的なフィードバックを提供する
- **期間**: 30日前〜今日
- **親目標**: 長期目標
- **タイプ**: skill

#### 短期目標1（1週間）

- **名前**: 新機能実装時にテストを先に書く
- **期間**: 7日前〜今日
- **親目標**: 中期目標1
- **タイプ**: habit

#### 短期目標2（1週間）

- **名前**: コードレビューで改善提案を含める
- **期間**: 7日前〜今日
- **親目標**: 中期目標2
- **タイプ**: skill

### 日報

- **期間**: 過去28日間（土日を除く）
- **内容**:
  - できごと: 業務内容の記録
  - 学び: 3日に1回程度
  - よかったこと: 2-3個/日
  - 改善点: 1-2個/日

### よかったこと・改善点

- **ステータス**: 未着手、進行中、再現成功、定着、完了、習慣化など
- **成功回数**: 1-7回
- **タグ**: TDD、開発効率、コードレビュー、フィードバック、チームワークなど

### フォローアップ

- **対象**: よかったこと10件、改善点8件
- **ステータス**: 再現成功、進行中、完了、未達成など
- **メモ**: 再現結果や改善の進捗を記録

### 週次フォーカス

- **期間**: 過去4週間
- **内容**: 各週に2-3個のフォーカス
- **目標との紐付け**: 短期目標や中期目標と紐付け

### 日報-目標紐付け

- **1週目**: 短期目標1を紐付け
- **2週目**: 短期目標2を紐付け
- **3-4週目**: 中期目標を紐付け

---

## ⚠️ 注意事項

1. **既存データの上書き**
   - 既存のユーザー（demo@example.com）が存在する場合、上書きされます
   - 既存のデータを保持したい場合は、スクリプトを実行する前にバックアップを取ってください

2. **本番環境での実行**
   - 本番環境では実行しないでください
   - 開発環境・デモ環境でのみ使用してください

3. **データベースの状態**
   - スクリプト実行前に、データベースが初期化されている必要があります
   - テーブルが存在しない場合は、自動的に作成されます

---

## 🔧 カスタマイズ

スクリプトを編集することで、以下のカスタマイズが可能です：

- ユーザー数やメールアドレスの変更
- 日報の件数や期間の変更
- 目標の階層構造の変更
- よかったこと・改善点の内容の変更

編集ファイル: `apps/api/scripts/seed-demo-data.ts`

---

## 📊 データ確認

スクリプト実行後、以下の方法でデータを確認できます：

1. **API経由で確認**

   ```bash
   # ログイン
   curl -X POST http://localhost:3000/api/auth/login \
     -H "Content-Type: application/json" \
     -d '{"email":"demo@example.com","password":"password123"}'

   # 日報一覧を取得
   curl -X GET http://localhost:3000/api/daily-reports \
     -H "Authorization: Bearer {token}"
   ```

2. **データベースを直接確認**
   ```bash
   sqlite3 apps/api/data/daily-report.db
   .tables
   SELECT COUNT(*) FROM users;
   SELECT COUNT(*) FROM daily_reports;
   SELECT COUNT(*) FROM goals;
   ```

---

## 🐛 トラブルシューティング

### エラー: データベースが見つからない

**原因**: データベースファイルが存在しない

**解決策**:

```bash
# APIサーバーを一度起動してデータベースを初期化
cd apps/api
npm run dev
# その後、Ctrl+Cで停止してからseedスクリプトを実行
npm run seed:demo
```

### エラー: ユーザーが既に存在する

**原因**: 既にdemo@example.comのユーザーが存在する

**解決策**:

- 既存のユーザーを削除するか、スクリプト内のメールアドレスを変更してください

---

**参考**:

- [データ永続化機能 Tech Spec](../features/data-persistence/tech_spec.md)
- [日報入力機能 PRD](../features/daily-report-input/prd.md)
- [目標階層管理機能 PRD](../features/goal-hierarchy-management/prd.md)

# 日報入力機能 技術リサーチ（Tech Research）

## 1. PRD要求サマリ
- 日報入力（日付、できごと、学び、よかったこと、改善点/アクション）
- よかったこと・改善点は「要因」「次のアクション」とセットで記録
- 保存完了メッセージ or 一覧画面へ遷移
- モバイル/PC両対応

---

## 2. 一般的な実現方法

### 2.1 データ構造パターン

| パターン | 特徴 | 適用ケース |
|:---------|:-----|:-----------|
| **フラット構造** | 全項目を1レコードに | シンプルな日報、項目固定 |
| **正規化（別テーブル）** | よかったこと/改善点を別エンティティ | フォローアップ、タグ管理が必要 |
| **JSONカラム** | 構造化データをJSON保存 | 柔軟だがクエリ複雑 |

### 2.2 API設計パターン

| パターン | 特徴 |
|:---------|:-----|
| **REST** | CRUD操作が明確、キャッシュしやすい |
| **GraphQL** | 柔軟なクエリ、オーバーフェッチ防止 |
| **RPC風** | シンプル、アクション単位 |

### 2.3 ベストプラクティス

#### フォーム送信
- **楽観的UI更新**：送信即座にUI反映、エラー時ロールバック
- **デバウンス**：連続送信防止（ボタン非活性化）
- **バリデーション**：クライアント + サーバー両方で実施

#### データ永続化
- **トランザクション**：日報 + よかったこと + 改善点を一括保存
- **タイムスタンプ**：createdAt / updatedAt 自動付与
- **ソフトデリート**：物理削除せず論理削除（deletedAt）

---

## 3. 類似サービスの技術構成

| サービス | データ構造 | 特徴 |
|:---------|:-----------|:-----|
| **nanoty** | フラット + 添付ファイル | シンプル、研修向け |
| **Notion** | ブロック構造 | 柔軟、ネスト可能 |
| **Slack日報Bot** | メッセージ + 構造化データ | 会話形式で入力 |

---

## 4. 推奨構成（本プロジェクト向け）

### データモデル
- **正規化構造**を採用（DailyReport / GoodPoint / Improvement）
- よかったこと・改善点は独立エンティティ（フォローアップ対応）
- タグ・ステータス管理可能

### API
- **REST API**（シンプル、Angular HttpClientと相性良好）
- POST /api/daily-reports で一括作成
- PATCH で個別更新（フォローアップ時）

### バリデーション
- クライアント：Angular Reactive Forms
- サーバー：class-validator（NestJS）or Joi

---

## 5. 参考資料
- REST API Design Best Practices
- Angular Reactive Forms Documentation
- Database Normalization Patterns


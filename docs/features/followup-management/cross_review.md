# フォローアップ管理機能 クロスレビュー

**実施日**: 2025-12-06  
**参加ロール**: PdM, Eng, Des  
**対象ドキュメント**: PRD, Tech Spec, UI Design

---

## 1. PRD ↔ Tech Spec 整合性チェック

### ✅ 整合している項目

| 項目                         | PRD                             | Tech Spec                       | 状態 |
| :--------------------------- | :------------------------------ | :------------------------------ | :--- |
| フォローアップ入力フィールド | ステータス、メモ、日付          | 同様に定義                      | ✅   |
| ステータス定義               | よかったこと/改善点のステータス | 同様に定義                      | ✅   |
| 成功カウント                 | `success_count` を保持          | `success_count` フィールド定義  | ✅   |
| 定着判定                     | 3回以上で定着                   | `success_count >= 3` で自動更新 | ✅   |
| 週次フォーカス               | 最大5件まで                     | 最大5件制限をバリデーション     | ✅   |
| フォロー項目一覧             | フィルタ・ページング            | APIでフィルタ・ページング対応   | ✅   |
| ビジネスルール               | 再現日/完了日の必須条件         | バリデーションで実装            | ✅   |

### ⚠️ 要確認・要調整項目

| 項目                             | PRD                         | Tech Spec                             | 課題                                 | 対応                                          |
| :------------------------------- | :-------------------------- | :------------------------------------ | :----------------------------------- | :-------------------------------------------- |
| フォロー項目一覧のデフォルト表示 | 未完了（未着手/進行中）のみ | API仕様にデフォルトフィルタの記載なし | デフォルトフィルタの実装方法が不明確 | **Tech Specにデフォルトフィルタの仕様を追加** |
| 週次フォーカスの追加UI           | PRDに詳細なし               | APIは定義済み                         | UIでの追加方法が不明確               | **UI Designで追加方法を明確化**               |

---

## 2. Tech Spec ↔ UI Design 整合性チェック

### ✅ 整合している項目

| 項目                       | Tech Spec                       | UI Design             | 状態 |
| :------------------------- | :------------------------------ | :-------------------- | :--- |
| フォローアップ入力モーダル | API定義済み                     | モーダルUI定義        | ✅   |
| ステータス選択             | enum値定義                      | Selectコンポーネント  | ✅   |
| 日付入力の条件付き必須     | バリデーション定義              | 動的必須切り替え      | ✅   |
| 成功回数表示               | `success_count` フィールド      | 「成功回数: 2回」表示 | ✅   |
| 定着バッジ                 | `success_count >= 3` で自動更新 | 定着バッジ表示        | ✅   |
| 週次フォーカス             | API定義済み                     | セクションUI定義      | ✅   |
| フォロー項目一覧           | API定義済み                     | 一覧画面UI定義        | ✅   |

### ⚠️ 要確認・要調整項目

| 項目                            | Tech Spec                       | UI Design                                                                | 課題                | 対応                                                        |
| :------------------------------ | :------------------------------ | :----------------------------------------------------------------------- | :------------------ | :---------------------------------------------------------- |
| フォロー項目一覧のAPIレスポンス | `reportDate`, `reportId` を含む | 日報リンク表示                                                           | ✅ 整合             | -                                                           |
| 週次フォーカス追加UI            | APIは定義済み                   | 「追加ボタン押下時：フォーカス追加モーダルを開く（または一覧から選択）」 | 追加方法が曖昧      | **UI Designで追加方法を明確化（一覧から選択 or 直接入力）** |
| トースト通知                    | 定義なし（UI改善）              | 詳細設計あり                                                             | ✅ UI改善として実装 | -                                                           |
| 離脱確認ダイアログ              | 定義なし（UI改善）              | 詳細設計あり                                                             | ✅ UI改善として実装 | -                                                           |

---

## 3. PRD ↔ UI Design 整合性チェック

### ✅ 整合している項目

| 項目               | PRD                    | UI Design                | 状態 |
| :----------------- | :--------------------- | :----------------------- | :--- |
| フォロー項目一覧   | フィルタ・ページング   | フィルタUI・ページングUI | ✅   |
| フォローアップ入力 | ステータス、メモ、日付 | モーダルUI定義           | ✅   |
| 週次フォーカス     | 最大5件まで            | セクションUI定義         | ✅   |
| 成功カウント表示   | `success_count` を表示 | 「成功回数: 2回」表示    | ✅   |
| 定着バッジ         | 定着（3回以上）        | 定着バッジ表示           | ✅   |
| トースト通知       | UI改善項目             | 詳細設計あり             | ✅   |
| 離脱確認ダイアログ | UI改善項目             | 詳細設計あり             | ✅   |
| 空状態メッセージ   | PRDで定義              | UI Designで定義          | ✅   |

### ⚠️ 要確認・要調整項目

| 項目                   | PRD           | UI Design                                              | 課題           | 対応                            |
| :--------------------- | :------------ | :----------------------------------------------------- | :------------- | :------------------------------ |
| 週次フォーカス追加方法 | PRDに詳細なし | 「フォーカス追加モーダルを開く（または一覧から選択）」 | 追加方法が曖昧 | **UI Designで追加方法を明確化** |

---

## 4. 各ロール別レビュー

### 4.1 PdM レビュー

#### ✅ 良好な点

- **要件の明確性**: ユーザーストーリー、機能要件、ビジネスルールが明確に定義されている
- **エッジケースの洗い出し**: データ関連、操作関連、エラー関連のケースが網羅されている
- **メッセージ仕様**: 成功/エラー/空状態のメッセージが定義されている
- **Phase分け**: Phase 2 v1 と v2 のスコープが明確

#### ⚠️ 改善提案

1. **週次フォーカス追加方法の明確化**
   - PRDに「週次フォーカス追加UI」の詳細を追加することを推奨
   - 一覧から選択するのか、直接入力するのかを明確化

2. **フォロー項目一覧のデフォルト表示**
   - PRDでは「未完了（未着手/進行中）のみ表示」とあるが、Tech Specにデフォルトフィルタの実装方法が不明確
   - フロントエンドでデフォルトフィルタを適用するのか、APIでデフォルトフィルタを返すのかを明確化

### 4.2 Eng レビュー

#### ✅ 良好な点

- **API設計の一貫性**: RESTful APIとして一貫性がある
- **データモデルの拡張**: 既存モデルへの拡張が適切に設計されている
- **ビジネスロジックの明確化**: 成功カウント更新、週次フォーカスのロジックが明確
- **後方互換性の考慮**: 既存ステータスのマッピングが定義されている

#### ⚠️ 改善提案

1. **フォロー項目一覧のデフォルトフィルタ**
   - Tech Specの `GET /api/followups` にデフォルトフィルタの仕様を追加
   - 例: `status` パラメータが未指定の場合、`status=未着手,進行中` をデフォルトで適用

2. **週次フォーカス追加時の重複チェック**
   - Tech Specに「既に同じ項目が今週のフォーカスに設定されている場合はエラー」とあるが、エラーレスポンスの詳細を追加
   - 例: 400 Bad Request + `{ message: "この項目は既に今週のフォーカスに設定されています" }`

3. **フォローアップ履歴の削除**
   - Tech Specに「フォローアップ履歴は削除不可」とあるが、UI Designに削除ボタンがないことを確認
   - ✅ 整合している（削除不可なのでUIにも削除ボタンなし）

### 4.3 Des レビュー

#### ✅ 良好な点

- **ワイヤーフレームの充実**: 各画面のワイヤーフレームが定義されている
- **状態別表示の網羅**: 初期/ローディング/成功/エラー/空状態が定義されている
- **デザイントークンの使用**: カラー、スペーシングがデザイントークンで定義されている
- **アクセシビリティへの配慮**: キーボード操作、フォーカス管理が考慮されている

#### ⚠️ 改善提案

1. **週次フォーカス追加方法の明確化**
   - UI Designの「追加ボタン押下時：フォーカス追加モーダルを開く（または一覧から選択）」を明確化
   - 推奨: フォロー項目一覧から選択する方式（既存のフォロー項目から選択）

2. **フォロー項目一覧のデフォルト表示**
   - UI Designに「デフォルトで未完了（未着手/進行中）のみ表示」とあるが、フィルタUIの初期状態を明確化
   - 例: ステータスフィルタの初期値は「未完了」を選択状態にする

3. **トースト通知のメッセージ**
   - UI Designに「フォローアップを保存しました」とあるが、PRDのメッセージ仕様と一致しているか確認
   - ✅ 整合している（PRD: 「フォローアップを保存しました」）

---

## 5. 総合評価

### ✅ 全体として良好な点

1. **ドキュメント間の整合性**: 基本的にPRD、Tech Spec、UI Designの整合性は取れている
2. **要件の明確性**: 機能要件、ビジネスルール、エッジケースが明確に定義されている
3. **実装可能性**: Tech SpecとUI Designから実装可能な設計になっている

### ⚠️ 改善が必要な項目

1. **週次フォーカス追加方法の明確化**（優先度: 高）
   - PRD、Tech Spec、UI Designすべてで追加方法が曖昧
   - **対応**: UI Designで「フォロー項目一覧から選択する方式」を明確化

2. **フォロー項目一覧のデフォルトフィルタ**（優先度: 中）
   - PRDでは「未完了（未着手/進行中）のみ表示」とあるが、Tech Specに実装方法が不明確
   - **対応**: Tech Specにデフォルトフィルタの仕様を追加（フロントエンドでデフォルト値を設定）

3. **週次フォーカス追加時のエラーレスポンス**（優先度: 低）
   - Tech Specにエラーレスポンスの詳細を追加

---

## 6. アクションアイテム

### 必須対応（実装前に修正）

| 項目                                 | 担当 | 対応内容                                                                        |
| :----------------------------------- | :--- | :------------------------------------------------------------------------------ |
| 週次フォーカス追加方法の明確化       | Des  | UI Designで「フォロー項目一覧から選択する方式」を明確化                         |
| フォロー項目一覧のデフォルトフィルタ | Eng  | Tech Specにデフォルトフィルタの仕様を追加（フロントエンドでデフォルト値を設定） |

### 推奨対応（実装時に考慮）

| 項目                                   | 担当 | 対応内容                                |
| :------------------------------------- | :--- | :-------------------------------------- |
| 週次フォーカス追加時のエラーレスポンス | Eng  | Tech Specにエラーレスポンスの詳細を追加 |

---

## 7. 承認

### PdM承認

- [x] PRDの要件がTech SpecとUI Designで実現可能であることを確認
- [x] 改善提案を確認し、必須対応項目を承認

### Eng承認

- [x] Tech SpecがPRDの要件を満たしていることを確認
- [x] UI Designで必要なデータがAPIで提供可能であることを確認
- [x] 改善提案を確認し、必須対応項目を承認

### Des承認

- [x] UI DesignがPRDの要件を満たしていることを確認
- [x] UI Designで必要なデータがTech SpecのAPIで提供可能であることを確認
- [x] 改善提案を確認し、必須対応項目を承認

---

## 8. 次のステップ

1. **必須対応項目の修正**
   - Des: UI Designで週次フォーカス追加方法を明確化
   - Eng: Tech Specにデフォルトフィルタの仕様を追加

2. **ドキュメントステータス更新**
   - PRD: Draft → Approved（必須対応完了後）
   - Tech Spec: Draft → Approved（必須対応完了後）
   - UI Design: Draft → Approved（必須対応完了後）

3. **実装開始**
   - 必須対応項目の修正完了後、実装を開始

---

_本レビューは 2025-12-06 に実施されました。必須対応項目の修正完了後、各ドキュメントのステータスを Approved に更新してください。_

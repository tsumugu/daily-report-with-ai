# フォローアップ履歴確認機能 PRD

**バージョン**: Phase 2 v2  
**作成日**: 2025-12-06  
**作成者**: PdM  
**ステータス**: Draft  
**承認日**: -  
**承認者**: -

---

## 1. 概要（Why）

### 背景

フォローアップ管理機能で「よかったこと」「改善点」に対してフォローアップを入力できるようになったが、**過去に入力したフォローアップの履歴を確認できない**。ユーザーが進捗を振り返り、成長を実感するためには、履歴を確認できる仕組みが必要。

### 目的

- 過去に入力したフォローアップの履歴を確認し、進捗を振り返る
- どのようにステータスが変化してきたかを可視化する
- 成長を実感し、継続的な振り返り習慣を形成する

---

## 2. ユーザーストーリー

### US-1: フォローアップ履歴の確認

```
As a ユーザー
I want to 過去に入力したフォローアップの履歴を確認したい
So that どのように進捗してきたかを振り返り、成長を実感できる
```

---

## 3. 機能要件

### 3.1 フォローアップ履歴の表示

| 項目           | 仕様                                                                 |
| :------------- | :------------------------------------------------------------------- |
| 表示場所       | フォローアップ入力モーダル内に履歴セクションを追加                   |
| 表示内容       | 過去に入力したフォローアップの一覧（ステータス、メモ、日付、作成日時） |
| ソート         | 作成日時の降順（新しい順）                                           |
| 表示条件       | フォローアップが1件以上ある場合のみ表示                             |
| 空状態         | フォローアップが0件の場合は「まだフォローアップがありません」と表示 |
| 表示件数       | すべての履歴を表示（ページングなし）                                 |

### 3.2 履歴項目の表示内容

| 項目       | 仕様                                 |
| :--------- | :----------------------------------- |
| ステータス | フォローアップ時のステータスを表示   |
| メモ       | 入力したメモを表示（最大500文字）    |
| 日付       | 再現日/完了日を表示（入力されている場合） |
| 作成日時   | フォローアップを入力した日時を表示   |

---

## 4. 非機能要件

| 項目             | 仕様                                              |
| :--------------- | :------------------------------------------------ |
| レスポンシブ対応 | モバイル/PC両対応                                 |
| パフォーマンス   | 履歴一覧の取得は500ms以内                         |
| アクセシビリティ | キーボード操作対応                                |
| データ整合性     | 履歴は対象のよかったこと/改善点に紐付く            |

---

## 5. 成功基準

| 基準                 | 測定方法                                                               |
| :------------------- | :--------------------------------------------------------------------- |
| 履歴確認率           | フォローアップを入力したユーザーのうち、履歴を1回以上確認した割合 ≥ 40% |
| ユーザビリティ       | 履歴の確認が2タップ以内で完了できる                                    |

---

## 6. エッジケースの洗い出し

### 6.1 データ関連

| ケース                                | 対応                                               |
| :------------------------------------ | :------------------------------------------------- |
| フォローアップが0件                   | 「まだフォローアップがありません」と表示           |
| 対象のよかったこと/改善点が削除された   | 履歴も連動して削除                                 |

### 6.2 操作関連

| ケース                          | 対応                       |
| :------------------------------ | :------------------------- |
| 履歴が多数ある場合              | スクロールで全履歴を表示     |

### 6.3 エラー関連

| ケース                | 対応                                         |
| :-------------------- | :------------------------------------------- |
| ネットワークエラー    | リトライボタン付きエラーメッセージ表示       |
| 認証切れ              | ログイン画面へリダイレクト                   |
| サーバーエラー（500） | 「しばらく経ってから再試行してください」表示 |

---

## 7. メッセージ仕様

### 7.1 エラーメッセージ

| 状況               | メッセージ                                                     |
| :----------------- | :------------------------------------------------------------- |
| ネットワークエラー | 「通信エラーが発生しました。再試行してください」               |
| サーバーエラー     | 「エラーが発生しました。しばらく経ってから再試行してください」 |

### 7.2 空状態メッセージ

| 状況            | メッセージ                                                                             |
| :-------------- | :------------------------------------------------------------------------------------- |
| フォローアップ0件 | 「まだフォローアップがありません」                                                   |

---

## 8. 画面遷移図

```
[フォロー項目一覧] / [日報詳細]
    │
    └──→ [フォローアップ入力モーダル]
              │
              ├──→ [フォームセクション]（新規入力）
              │
              └──→ [履歴セクション]（過去のフォローアップ一覧）
```

### 遷移詳細

| 操作                                     | 遷移先                          |
| :--------------------------------------- | :------------------------------ |
| フォロー項目一覧でカード押下             | フォローアップ入力モーダル（履歴表示） |
| 日報詳細で「よかったこと」「改善点」押下 | フォローアップ入力モーダル（履歴表示） |

---

## 9. ビジネスルール

| ルール                     | 説明                                                                 |
| :------------------------- | :------------------------------------------------------------------- |
| 履歴はすべて表示           | ページングなしで、すべての履歴を表示                                 |
| 削除は連動                 | 対象のよかったこと/改善点が削除された場合、履歴も連動削除           |

---

## 10. API設計（概要）

※ 詳細は `tech_spec.md` で定義

| エンドポイント                     | メソッド | 説明                                 |
| :--------------------------------- | :------- | :----------------------------------- |
| `/api/good-points/{id}/followups`  | GET      | よかったことのフォローアップ履歴取得 |
| `/api/improvements/{id}/followups` | GET      | 改善点のフォローアップ履歴取得       |

**補足**: 既存のフォローアップ管理機能で実装済みのAPIを利用する。

---

## 11. 他ロールへの依頼

### To Eng

- `tech_spec.md` で以下を定義してください：
  - フロントエンド状態管理（履歴取得・表示）
  - エラーハンドリング
  - 既存APIとの連携方法

### To Des

- `ui_design.md` で以下を定義してください：
  - フォローアップ入力モーダル内の履歴セクションUI
  - 履歴項目の表示デザイン
  - 空状態のデザイン

---

## 12. 関連ドキュメント

| ドキュメント                              | 説明                         |
| :---------------------------------------- | :--------------------------- |
| `docs/features/followup-management/prd.md` | フォローアップ管理機能の仕様 |
| `docs/general/roadmap.md`                 | Phase 2 の位置付け           |

---

## 13. Phase分け

### Phase 2 v2（MVP）

- ✅ フォローアップ履歴の表示（モーダル内）
- ✅ 履歴項目の詳細表示（ステータス、メモ、日付、作成日時）

### 将来実装（Phase 3以降）

- 履歴の編集・削除
- 履歴のフィルタリング（ステータス別、日付別）
- 履歴の統計表示（グラフなど）

---

_本PRDは Draft ステータスです。Eng/Des とのクロスレビュー後に承認予定です。_


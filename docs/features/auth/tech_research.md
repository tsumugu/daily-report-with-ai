# ユーザー認証機能 技術リサーチ（Tech Research）

## 1. PRD要求サマリ
- メールアドレス + パスワードによるログイン/サインアップ
- ログアウト機能
- パスワードはハッシュ化して保存
- セッション管理（トークンベース or Cookie）
- 未認証時は日報機能へアクセス不可

---

## 2. 一般的な実現方法

### 2.1 認証方式の比較

| 方式 | 特徴 | メリット | デメリット |
|:-----|:-----|:---------|:-----------|
| **JWT（JSON Web Token）** | トークンベース、ステートレス | サーバー負荷低、スケーラブル、SPA向き | トークン無効化が難しい、サイズが大きい |
| **セッションCookie** | サーバー側でセッション管理 | 即時無効化可能、シンプル | サーバー負荷、スケール時にセッション共有必要 |
| **Firebase Auth** | BaaS、マネージド | 実装が最小限、ソーシャルログイン容易 | ベンダーロックイン、カスタマイズ制限 |

### 2.2 ベストプラクティス

#### パスワード管理
- **bcrypt** または **Argon2** でハッシュ化（SHA256単体はNG）
- ソルトは自動生成（bcryptは内蔵）
- ストレッチング回数は10以上推奨

#### トークン管理（JWT採用時）
- アクセストークン：短寿命（15分〜1時間）
- リフレッシュトークン：長寿命（7日〜30日）、HTTP Only Cookieで保存
- トークンはlocalStorageに保存しない（XSS対策）

#### セキュリティ
- HTTPS必須
- CORS設定を厳密に
- レートリミット（ブルートフォース対策）
- パスワードポリシー（最低8文字、英数字混合推奨）

---

## 3. 類似サービスの技術構成

| サービス | 認証方式 | 特徴 |
|:---------|:---------|:-----|
| **Notion** | JWT + リフレッシュトークン | Google/Apple SSO対応 |
| **Slack** | OAuth 2.0 + セッション | ワークスペース単位の認証 |
| **GitHub** | JWT + OAuth | Personal Access Token対応 |

---

## 4. 推奨構成（本プロジェクト向け）

### Phase 1（MVP）
- **JWT認証**（ステートレスでSPA向き）
- アクセストークン：HTTP Only Cookie or Authorization Header
- パスワードハッシュ：bcrypt
- バックエンド：Node.js（Express/NestJS）or Firebase Auth

### Phase 2以降
- リフレッシュトークン導入
- ソーシャルログイン（Google）
- 2FA（二要素認証）検討

---

## 5. 参考資料
- OWASP Authentication Cheat Sheet
- JWT.io Introduction
- Auth0 Best Practices


import{b as A}from"./chunk-ZCBRORG4.js";import"./chunk-VIH4BLUS.js";import{a as L}from"./chunk-EKI7JIHQ.js";import{a as F}from"./chunk-IRG3K2SF.js";import{c as k}from"./chunk-67QQE4MI.js";import{a as E}from"./chunk-EHRPYQYN.js";import{r as S}from"./chunk-BNY3RDUL.js";import"./chunk-IY3UEH2H.js";import"./chunk-S7Y6GWYN.js";import{a as R,b as D}from"./chunk-GCOMOK3V.js";import{e as b,s as O,t as w}from"./chunk-H77UF764.js";import{$ as y,Ba as a,Ka as x,Pa as g,S as C,Wa as u,_ as f,_a as c,ab as v,bb as M,cb as o,db as r,eb as m,fb as h,ib as _,jb as s,na as d,pb as l,qb as P}from"./chunk-TUMKYTCV.js";import"./chunk-4CLCTAJ7.js";var z=(e,t)=>t.id;function I(e,t){if(e&1&&(o(0,"span",6),l(1),r()),e&2){let n,i=s();a(),P((n=i.currentUser())==null?null:n.email)}}function V(e,t){e&1&&(o(0,"div",13),m(1,"div",16),o(2,"p"),l(3,"\u8AAD\u307F\u8FBC\u307F\u4E2D..."),r()())}function j(e,t){if(e&1){let n=h();o(0,"div",14),m(1,"app-alert-banner",17),o(2,"app-button",18),_("clicked",function(){f(n);let p=s();return y(p.retry())}),l(3,"\u518D\u8AAD\u307F\u8FBC\u307F"),r()()}if(e&2){let n=s();a(),u("message",n.errorMessage())}}function U(e,t){e&1&&m(0,"app-empty-state",15)}function N(e,t){if(e&1){let n=h();o(0,"app-report-card",22),_("cardClick",function(p){f(n);let B=s(2);return y(B.onReportClick(p))}),r()}if(e&2){let n=t.$implicit;u("report",n)}}function $(e,t){e&1&&(m(0,"div",24),o(1,"p"),l(2,"\u8AAD\u307F\u8FBC\u307F\u4E2D..."),r())}function W(e,t){if(e&1){let n=h();o(0,"app-button",25),_("clicked",function(){f(n);let p=s(3);return y(p.loadMore())}),l(1,"\u3082\u3063\u3068\u898B\u308B"),r()}}function Y(e,t){if(e&1&&(o(0,"div",21),g(1,$,3,0)(2,W,2,0,"app-button",23),r()),e&2){let n=s(2);a(),c(n.isLoadingMore()?1:2)}}function q(e,t){if(e&1&&(o(0,"div",19),v(1,N,1,1,"app-report-card",20,z),r(),g(3,Y,3,1,"div",21)),e&2){let n=s();u("@listItem",void 0),a(),M(n.reports()),a(2),c(n.hasMore?3:-1)}}var T=class e{dailyReportService=C(F);authService=C(L);router=C(O);currentUser=this.authService.currentUser;reports=d([]);total=d(0);isLoading=d(!0);isLoadingMore=d(!1);errorMessage=d(null);offset=0;limit=30;ngOnInit(){this.loadReports()}loadReports(){this.isLoading.set(!0),this.errorMessage.set(null),this.offset=0,this.dailyReportService.getAll().subscribe({next:t=>{this.reports.set(t.data),this.total.set(t.total),this.offset=t.data.length,this.isLoading.set(!1)},error:t=>{this.isLoading.set(!1),this.errorMessage.set(t.error?.message||"\u65E5\u5831\u306E\u8AAD\u307F\u8FBC\u307F\u306B\u5931\u6557\u3057\u307E\u3057\u305F")}})}loadMore(){this.isLoadingMore()||this.offset>=this.total()||(this.isLoadingMore.set(!0),this.dailyReportService.getAllWithPaging(this.limit,this.offset).subscribe({next:t=>{this.reports.update(n=>[...n,...t.data]),this.offset+=t.data.length,this.isLoadingMore.set(!1)},error:()=>{this.isLoadingMore.set(!1)}}))}get hasMore(){return this.offset<this.total()}onReportClick(t){this.router.navigate(["/daily-reports",t])}logout(){this.authService.logout().subscribe({next:()=>{this.router.navigate(["/login"])},error:()=>{this.router.navigate(["/login"])}})}retry(){this.loadReports()}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=x({type:e,selectors:[["app-daily-report-list-page"]],decls:22,vars:6,consts:[[1,"list-container"],[1,"header"],[1,"header-content"],["routerLink","/",1,"logo"],["name","file-text","color","var(--color-primary-500)","ariaLabel","Daily Report",3,"size"],[1,"user-menu"],[1,"user-email"],[1,"logout-button",3,"click"],[1,"main"],[1,"page-header"],[1,"page-title"],["routerLink","/daily-reports/new",1,"new-report-button"],[1,"plus-icon"],[1,"loading-container"],[1,"error-container"],["iconName","clipboard","message","\u307E\u3060\u65E5\u5831\u304C\u3042\u308A\u307E\u305B\u3093","subMessage","\u4ECA\u65E5\u306E\u65E5\u5831\u3092\u66F8\u3044\u3066\u307F\u307E\u3057\u3087\u3046\uFF01","actionButtonText","\u65E5\u5831\u3092\u66F8\u304F","actionButtonRoute","/daily-reports/new","actionButtonIcon","plus"],[1,"spinner"],["variant","error",3,"message"],["variant","primary",3,"clicked"],[1,"report-list"],[3,"report"],[1,"load-more-container"],[3,"cardClick","report"],["variant","secondary"],[1,"spinner","spinner--small"],["variant","secondary",3,"clicked"]],template:function(n,i){n&1&&(o(0,"div",0)(1,"header",1)(2,"div",2)(3,"a",3),m(4,"app-icon",4),l(5," Daily Report "),r(),o(6,"div",5),g(7,I,2,1,"span",6),o(8,"button",7),_("click",function(){return i.logout()}),l(9,"\u30ED\u30B0\u30A2\u30A6\u30C8"),r()()()(),o(10,"main",8)(11,"div",9)(12,"h1",10),l(13,"\u65E5\u5831\u4E00\u89A7"),r(),o(14,"a",11)(15,"span",12),l(16,"\uFF0B"),r(),l(17," \u65E5\u5831\u3092\u66F8\u304F "),r()(),g(18,V,4,0,"div",13)(19,j,4,1,"div",14)(20,U,1,0,"app-empty-state",15)(21,q,4,2),r()()),n&2&&(a(4),u("size",24),a(3),c(i.currentUser()?7:-1),a(11),c(i.isLoading()?18:-1),a(),c(i.errorMessage()?19:-1),a(),c(!i.isLoading()&&!i.errorMessage()&&i.reports().length===0?20:-1),a(),c(!i.isLoading()&&!i.errorMessage()&&i.reports().length>0?21:-1))},dependencies:[b,w,k,D,E,R,S],styles:[".list-container[_ngcontent-%COMP%]{min-height:100vh;background:var(--color-bg-secondary)}.header[_ngcontent-%COMP%]{background:var(--color-bg-primary);border-bottom:1px solid var(--color-border-default);padding:1rem 2rem}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}.header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--color-primary-500);text-decoration:none;display:flex;align-items:center;gap:.5rem;transition:opacity .2s}.header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]:hover{opacity:.8;text-decoration:none}.header[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.header[_ngcontent-%COMP%]   .user-email[_ngcontent-%COMP%]{font-size:.875rem;color:var(--color-text-secondary)}.header[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:.875rem;font-weight:500;color:var(--color-text-secondary);background:var(--color-bg-primary);border:1px solid var(--color-border-default);border-radius:6px;cursor:pointer;transition:all .2s}.header[_ngcontent-%COMP%]   .logout-button[_ngcontent-%COMP%]:hover{color:var(--color-text-primary);border-color:var(--color-border-hover)}.main[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:2rem}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:var(--color-text-primary);margin:0}.new-report-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.25rem;background:var(--color-primary-500);color:#fff;font-size:.875rem;font-weight:600;border-radius:8px;text-decoration:none;transition:background .2s,transform .2s}.new-report-button[_ngcontent-%COMP%]:hover{background:var(--color-primary-600);transform:translateY(-1px)}.new-report-button--large[_ngcontent-%COMP%]{padding:1rem 1.5rem;font-size:1rem}.new-report-button[_ngcontent-%COMP%]   .plus-icon[_ngcontent-%COMP%]{font-size:1rem}.report-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:1rem;color:var(--color-text-secondary)}.error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;padding:2rem;background:var(--color-bg-primary);border-radius:12px;text-align:center}.empty-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:4rem 2rem;background:var(--color-bg-primary);border-radius:12px;text-align:center}.empty-container[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.empty-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:var(--color-text-primary);margin:0 0 .5rem}.empty-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-secondary);margin:0 0 1.5rem}.load-more-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:2rem}.load-more-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:.5rem;color:var(--color-text-secondary);font-size:.875rem}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--color-gray-200);border-top-color:var(--color-primary-500);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.spinner--small[_ngcontent-%COMP%]{width:24px;height:24px;border-width:2px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 640px){.header[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.header[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.main[_ngcontent-%COMP%]{padding:1rem}.page-header[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.new-report-button[_ngcontent-%COMP%]{justify-content:center}}"],data:{animation:[A]}})};export{T as DailyReportListPageComponent};

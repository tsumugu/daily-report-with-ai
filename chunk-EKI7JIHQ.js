import{f as h,j as c,s as g}from"./chunk-H77UF764.js";import{Gb as u,J as i,M as a,S as o,k as s,na as l,ra as p,v as t}from"./chunk-TUMKYTCV.js";var m={production:!0,apiUrl:"https://daily-report-api-f5noaichsq-an.a.run.app/api",appName:"Daily Report"};var d=class n{http=o(c);router=o(g);platformId=o(p);apiUrl=`${m.apiUrl}/auth`;currentUserSignal=l(null);currentUser=this.currentUserSignal.asReadonly();isAuthenticated=u(()=>this.currentUserSignal()!==null);signup(r){return this.http.post(`${this.apiUrl}/signup`,r).pipe(i(e=>{this.setToken(e.token),this.currentUserSignal.set(e.user)}),t(this.handleError))}login(r){return this.http.post(`${this.apiUrl}/login`,r).pipe(i(e=>{this.setToken(e.token),this.currentUserSignal.set(e.user)}),t(this.handleError))}logout(){return this.http.post(`${this.apiUrl}/logout`,{}).pipe(i(()=>{this.clearToken(),this.currentUserSignal.set(null),this.router.navigate(["/login"])}),t(this.handleError))}getMe(){return this.http.get(`${this.apiUrl}/me`).pipe(i(r=>{this.currentUserSignal.set(r)}),t(this.handleError))}isBrowser(){return h(this.platformId)}getToken(){return this.isBrowser()?localStorage.getItem("auth_token"):null}setToken(r){this.isBrowser()&&localStorage.setItem("auth_token",r)}clearToken(){this.isBrowser()&&localStorage.removeItem("auth_token")}handleError(r){return console.error("Auth error:",r),s(()=>r)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=a({token:n,factory:n.\u0275fac,providedIn:"root"})};export{d as a};

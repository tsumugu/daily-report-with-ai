import{f as h,j as c,s as m}from"./chunk-H77UF764.js";import{Gb as u,J as o,M as a,S as i,k as s,na as l,ra as p,v as t}from"./chunk-TUMKYTCV.js";var g={production:!0,apiUrl:process.env.API_URL||"https://api.example.com/api",appName:"Daily Report"};var v=class n{http=i(c);router=i(m);platformId=i(p);apiUrl=`${g.apiUrl}/auth`;currentUserSignal=l(null);currentUser=this.currentUserSignal.asReadonly();isAuthenticated=u(()=>this.currentUserSignal()!==null);signup(e){return this.http.post(`${this.apiUrl}/signup`,e).pipe(o(r=>{this.setToken(r.token),this.currentUserSignal.set(r.user)}),t(this.handleError))}login(e){return this.http.post(`${this.apiUrl}/login`,e).pipe(o(r=>{this.setToken(r.token),this.currentUserSignal.set(r.user)}),t(this.handleError))}logout(){return this.http.post(`${this.apiUrl}/logout`,{}).pipe(o(()=>{this.clearToken(),this.currentUserSignal.set(null),this.router.navigate(["/login"])}),t(this.handleError))}getMe(){return this.http.get(`${this.apiUrl}/me`).pipe(o(e=>{this.currentUserSignal.set(e)}),t(this.handleError))}isBrowser(){return h(this.platformId)}getToken(){return this.isBrowser()?localStorage.getItem("auth_token"):null}setToken(e){this.isBrowser()&&localStorage.setItem("auth_token",e)}clearToken(){this.isBrowser()&&localStorage.removeItem("auth_token")}handleError(e){return console.error("Auth error:",e),s(()=>e)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=a({token:n,factory:n.\u0275fac,providedIn:"root"})};export{v as a};

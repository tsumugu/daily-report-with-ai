<div class="daily-report-input">
  <!-- „Éò„ÉÉ„ÉÄ„Éº -->
  <header class="header">
    <a routerLink="/daily-reports" class="back-link">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m15 18-6-6 6-6"/>
      </svg>
    </a>
    <h1 class="title">Êó•Â†±„ÇíÊõ∏„Åè</h1>
  </header>

  <!-- „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏ -->
  @if (errorMessage()) {
    <app-alert-banner
      [message]="errorMessage()!"
      variant="error"
      [dismissible]="true"
      (dismissed)="errorMessage.set(null)"
    />
  }

  <!-- „Éï„Ç©„Éº„É† -->
  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="form">
    <!-- Êó•‰ªò -->
    <app-date-field
      label="Êó•‰ªò"
      id="date"
      formControlName="date"
      [required]="true"
      [errorMessage]="getFieldError('date') || ''"
    />

    <!-- „Åß„Åç„Åî„Å® -->
    <app-textarea-field
      label="„Åß„Åç„Åî„Å®"
      id="events"
      labelIcon="üìù"
      formControlName="events"
      [required]="true"
      [maxLength]="MAX_LENGTH"
      [rows]="4"
      placeholder="‰ªäÊó•„ÅÆ‰∏ª„Å™Ê•≠ÂãôÂÜÖÂÆπ„ÄÅÂá∫Êù•‰∫ã„ÇíË®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ"
      [errorMessage]="getFieldError('events') || ''"
    />

    <!-- Â≠¶„Å≥ -->
    <app-textarea-field
      label="Â≠¶„Å≥"
      id="learnings"
      labelIcon="üí°"
      formControlName="learnings"
      [maxLength]="MAX_LENGTH"
      [rows]="3"
      placeholder="Ê•≠Âãô„ÇíÈÄö„Åò„Å¶Âæó„ÅüÊ∞ó„Å•„Åç„ÄÅÂ≠¶„Å≥„ÇíË®òÂÖ•„Åó„Å¶„Åè„Å†„Åï„ÅÑ"
    />

    <!-- „Çà„Åã„Å£„Åü„Åì„Å® -->
    <div class="form-group">
      <label class="label">
        <span class="label-icon">‚ú®</span>
        „Çà„Åã„Å£„Åü„Åì„Å®
      </label>

      @for (gp of goodPoints(); track $index) {
        <app-form-card (removed)="removeGoodPoint($index)" class="form-group__card">
          <div class="card-field">
            <app-textarea-field
              [label]="'ÂÜÖÂÆπ'"
              [id]="'good-point-content-' + $index"
              [maxLength]="MAX_LENGTH"
              [rows]="2"
              [showCharCount]="false"
              placeholder="„ÅÜ„Åæ„Åè„ÅÑ„Å£„Åü„Åì„Å®„ÄÅÊàêÂäü‰ΩìÈ®ì"
              [value]="gp.content"
              (valueChange)="updateGoodPoint($index, 'content', $event)"
            />
          </div>
          <div class="card-field">
            <app-textarea-field
              [label]="'Ë¶ÅÂõ†„ÉªËÉåÊôØ'"
              [id]="'good-point-factors-' + $index"
              [maxLength]="MAX_LENGTH"
              [rows]="2"
              [showCharCount]="false"
              placeholder="„Å™„Åú„ÅÜ„Åæ„Åè„ÅÑ„Å£„Åü„Åã"
              [value]="gp.factors"
              (valueChange)="updateGoodPoint($index, 'factors', $event)"
            />
          </div>
        </app-form-card>
      }

      <app-button variant="add" icon="plus" [fullWidth]="true" (clicked)="addGoodPoint()">ËøΩÂä†</app-button>
    </div>

    <!-- ÊîπÂñÑÁÇπ/„Ç¢„ÇØ„Ç∑„Éß„É≥ -->
    <div class="form-group">
      <label class="label">
        <span class="label-icon">üìà</span>
        ÊîπÂñÑÁÇπ/„Ç¢„ÇØ„Ç∑„Éß„É≥
      </label>

      @for (imp of improvements(); track $index) {
        <app-form-card (removed)="removeImprovement($index)" class="form-group__card">
          <div class="card-field">
            <app-textarea-field
              [label]="'ÊîπÂñÑ„Åó„Åü„ÅÑ„Åì„Å®'"
              [id]="'improvement-content-' + $index"
              [maxLength]="MAX_LENGTH"
              [rows]="2"
              [showCharCount]="false"
              placeholder="ÊîπÂñÑ„Åó„Åü„ÅÑÁÇπ„ÄÅË™≤È°å"
              [value]="imp.content"
              (valueChange)="updateImprovement($index, 'content', $event)"
            />
          </div>
          <div class="card-field">
            <app-textarea-field
              [label]="'„Ç¢„ÇØ„Ç∑„Éß„É≥'"
              [id]="'improvement-action-' + $index"
              [maxLength]="MAX_LENGTH"
              [rows]="2"
              [showCharCount]="false"
              placeholder="ÊòéÊó•‰ª•Èôç„Å´Ë©¶„Åó„Åü„ÅÑ„Åì„Å®"
              [value]="imp.action"
              (valueChange)="updateImprovement($index, 'action', $event)"
            />
          </div>
        </app-form-card>
      }

      <app-button variant="add" icon="plus" [fullWidth]="true" (clicked)="addImprovement()">ËøΩÂä†</app-button>
    </div>

    <!-- ‰øùÂ≠ò„Éú„Çø„É≥ -->
    <div class="form-actions">
      <app-button
        type="submit"
        variant="primary"
        [fullWidth]="true"
        [loading]="isLoading()"
        [disabled]="isLoading()"
      >
        ‰øùÂ≠ò„Åô„Çã
      </app-button>
    </div>
  </form>
</div>

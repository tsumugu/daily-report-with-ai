<div class="detail-container">
  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <a routerLink="/" class="logo">ğŸ“ Daily Report</a>
      <div class="user-menu">
        @if (currentUser()) {
          <span class="user-email">{{ currentUser()?.email }}</span>
        }
        <button class="logout-button" (click)="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main">
    <!-- Back button -->
    <div class="back-nav">
      <button class="back-button" (click)="goBack()">
        <span class="back-icon">â†</span>
        ä¸€è¦§ã«æˆ»ã‚‹
      </button>
    </div>

    <!-- Loading -->
    @if (isLoading()) {
      <div class="loading-container">
        <div class="spinner"></div>
        <p>èª­ã¿è¾¼ã¿ä¸­...</p>
      </div>
    }

    <!-- Error -->
    @if (errorMessage()) {
      <div class="error-container">
        <app-alert-banner variant="error" [message]="errorMessage()!" />
        <div class="error-actions">
          <app-button variant="outline" (clicked)="goBack()">ä¸€è¦§ã«æˆ»ã‚‹</app-button>
          <app-button variant="primary" (clicked)="retry()">å†èª­ã¿è¾¼ã¿</app-button>
        </div>
      </div>
    }

    <!-- Report Detail -->
    @if (!isLoading() && !errorMessage() && report()) {
      <article class="report-detail">
        <header class="report-header">
          <h1 class="report-date">
            <span class="date-icon">ğŸ“…</span>
            {{ formatDate(report()!.date) }}
          </h1>
          <!-- ç·¨é›†ãƒœã‚¿ãƒ³ï¼ˆPhase 1ã§ã¯éæ´»æ€§ï¼‰ -->
          <button class="edit-button" disabled title="ç·¨é›†æ©Ÿèƒ½ã¯æº–å‚™ä¸­ã§ã™">
            ç·¨é›†ã™ã‚‹
          </button>
        </header>

        <!-- ã§ãã”ã¨ -->
        <section class="section">
          <h2 class="section-title">ã§ãã”ã¨</h2>
          <div class="section-content">
            <p class="content-text">{{ report()!.events }}</p>
          </div>
        </section>

        <!-- å­¦ã³ -->
        @if (report()!.learnings) {
          <section class="section">
            <h2 class="section-title">å­¦ã³</h2>
            <div class="section-content">
              <p class="content-text">{{ report()!.learnings }}</p>
            </div>
          </section>
        }

        <!-- ã‚ˆã‹ã£ãŸã“ã¨ -->
        @if (report()!.goodPoints && report()!.goodPoints.length > 0) {
          <section class="section">
            <h2 class="section-title">
              <span class="title-icon">âœ¨</span>
              ã‚ˆã‹ã£ãŸã“ã¨
            </h2>
            <div class="items-list">
              @for (gp of report()!.goodPoints; track gp.id) {
                <div class="item-card">
                  <p class="item-content">{{ gp.content }}</p>
                  @if (gp.factors) {
                    <div class="item-sub">
                      <span class="sub-label">è¦å› ï¼š</span>
                      <span class="sub-value">{{ gp.factors }}</span>
                    </div>
                  }
                  <span class="status-badge status-badge--{{ gp.status === 'æœªå¯¾å¿œ' ? 'pending' : gp.status === 'å†ç¾æˆåŠŸ' ? 'success' : 'failed' }}">
                    {{ gp.status }}
                  </span>
                </div>
              }
            </div>
          </section>
        }

        <!-- æ”¹å–„ç‚¹ -->
        @if (report()!.improvements && report()!.improvements.length > 0) {
          <section class="section">
            <h2 class="section-title">
              <span class="title-icon">ğŸ“</span>
              æ”¹å–„ç‚¹ / ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
            </h2>
            <div class="items-list">
              @for (imp of report()!.improvements; track imp.id) {
                <div class="item-card">
                  <p class="item-content">{{ imp.content }}</p>
                  @if (imp.action) {
                    <div class="item-sub">
                      <span class="sub-label">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</span>
                      <span class="sub-value">{{ imp.action }}</span>
                    </div>
                  }
                  <span class="status-badge status-badge--{{ imp.status === 'æœªç€æ‰‹' ? 'pending' : imp.status === 'é€²è¡Œä¸­' ? 'in-progress' : 'completed' }}">
                    {{ imp.status }}
                  </span>
                </div>
              }
            </div>
          </section>
        }

        <!-- ãƒ¡ã‚¿æƒ…å ± -->
        <footer class="report-footer">
          <span class="meta-text">ä½œæˆ: {{ report()!.createdAt | date:'yyyy/MM/dd HH:mm' }}</span>
          @if (report()!.updatedAt !== report()!.createdAt) {
            <span class="meta-text">æ›´æ–°: {{ report()!.updatedAt | date:'yyyy/MM/dd HH:mm' }}</span>
          }
        </footer>
      </article>
    }
  </main>
</div>

